{"remainingRequest":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/src/components/message/merger-message/message-merger.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/src/components/message/merger-message/message-merger.vue","mtime":1648707124000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport {  mapState } from 'vuex'\nimport MergerMessageItem from './mergerMessage-item'\nimport { getFullDate } from '../../../utils/date'\nexport default {\n  name: 'CurrentConversation',\n  components: {\n    MergerMessageItem,\n  },\n  data() {\n    return {\n      preScrollHeight: 0,\n      mergerMessageList: [],\n      showMessage: null,\n\n    }\n  },\n  computed: {\n    ...mapState({\n      currentConversation: state => state.conversation.currentConversation,\n      mergerMessage: state => state.conversation.mergerMessage\n    }),\n    mergerList() {\n      return function(message) {\n        return message.payload.messageList\n      }\n    }\n  },\n  created () {\n  },\n  mounted() {\n\n  },\n  updated() {\n\n  },\n  watch: {\n\n  },\n  methods: {\n    getDate(time) {\n      return getFullDate(new Date(time * 1000))\n    },\n    onScroll({ target: { scrollTop } }) {\n      let messageListNode = this.$refs['message-list']\n      if (!messageListNode) {\n        return\n      }\n      if (this.preScrollHeight - messageListNode.clientHeight - scrollTop < 20) {\n        this.isShowScrollButtomTips = false\n      }\n    },\n    // 如果滚到底部就保持在底部，否则提示是否要滚到底部\n    keepMessageListOnButtom() {\n      let messageListNode = this.$refs['message-list']\n      if (!messageListNode) {\n        return\n      }\n      // 距离底部20px内强制滚到底部,否则提示有新消息\n      if (this.preScrollHeight - messageListNode.clientHeight - messageListNode.scrollTop < 20) {\n        this.$nextTick(() => {\n          messageListNode.scrollTop = messageListNode.scrollHeight\n        })\n        this.isShowScrollButtomTips = false\n      } else {\n        this.isShowScrollButtomTips = true\n      }\n      this.preScrollHeight = messageListNode.scrollHeight\n    },\n    // 直接滚到底部\n    scrollMessageListToButtom() {\n      this.$nextTick(() => {\n        let messageListNode = this.$refs['message-list']\n        if (!messageListNode) {\n          return\n        }\n        messageListNode.scrollTop = messageListNode.scrollHeight\n        this.preScrollHeight = messageListNode.scrollHeight\n        this.isShowScrollButtomTips = false\n      })\n    },\n    onImageLoaded() {\n      this.keepMessageListOnButtom()\n    }\n  }\n}\n",{"version":3,"sources":["message-merger.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"message-merger.vue","sourceRoot":"src/components/message/merger-message","sourcesContent":["<template>\n    <div class=\"merger-conversation-wrapper\">\n        <div class=\"current-conversation\" @scroll=\"onScroll\">\n            <div class=\"content\">\n                <div class=\"message-list\" ref=\"message-list\" @scroll=\"this.onScroll\">\n                    <div   v-for=\"(messageItem, index) in mergerList(mergerMessage)\" :key=\"index\">\n                        <div class=\"message-item\">\n                            <div class=\"avatar-box\">\n                                <avatar class=\"group-member-avatar\" :src=\"messageItem.avatar\"/>\n                            </div>\n                            <div class=\"container-box\">\n                                <div class=\"nick-date\">\n                                    <div class=\"name text-ellipsis\">{{messageItem.nick || messageItem.from || '小晨曦'}}</div>\n                                    <div class=\"date\">{{ getDate(messageItem.time) }}</div>\n                                </div>\n                                <merger-message-item v-for=\"(item,index) in messageItem.messageBody\" :key=\"index\" :message=\"item\" :payload=\"item.payload\"/>\n                            </div>\n                        </div>\n                        <el-divider></el-divider>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n  import {  mapState } from 'vuex'\n  import MergerMessageItem from './mergerMessage-item'\n  import { getFullDate } from '../../../utils/date'\n  export default {\n    name: 'CurrentConversation',\n    components: {\n      MergerMessageItem,\n    },\n    data() {\n      return {\n        preScrollHeight: 0,\n        mergerMessageList: [],\n        showMessage: null,\n\n      }\n    },\n    computed: {\n      ...mapState({\n        currentConversation: state => state.conversation.currentConversation,\n        mergerMessage: state => state.conversation.mergerMessage\n      }),\n      mergerList() {\n        return function(message) {\n          return message.payload.messageList\n        }\n      }\n    },\n    created () {\n    },\n    mounted() {\n\n    },\n    updated() {\n\n    },\n    watch: {\n\n    },\n    methods: {\n      getDate(time) {\n        return getFullDate(new Date(time * 1000))\n      },\n      onScroll({ target: { scrollTop } }) {\n        let messageListNode = this.$refs['message-list']\n        if (!messageListNode) {\n          return\n        }\n        if (this.preScrollHeight - messageListNode.clientHeight - scrollTop < 20) {\n          this.isShowScrollButtomTips = false\n        }\n      },\n      // 如果滚到底部就保持在底部，否则提示是否要滚到底部\n      keepMessageListOnButtom() {\n        let messageListNode = this.$refs['message-list']\n        if (!messageListNode) {\n          return\n        }\n        // 距离底部20px内强制滚到底部,否则提示有新消息\n        if (this.preScrollHeight - messageListNode.clientHeight - messageListNode.scrollTop < 20) {\n          this.$nextTick(() => {\n            messageListNode.scrollTop = messageListNode.scrollHeight\n          })\n          this.isShowScrollButtomTips = false\n        } else {\n          this.isShowScrollButtomTips = true\n        }\n        this.preScrollHeight = messageListNode.scrollHeight\n      },\n      // 直接滚到底部\n      scrollMessageListToButtom() {\n        this.$nextTick(() => {\n          let messageListNode = this.$refs['message-list']\n          if (!messageListNode) {\n            return\n          }\n          messageListNode.scrollTop = messageListNode.scrollHeight\n          this.preScrollHeight = messageListNode.scrollHeight\n          this.isShowScrollButtomTips = false\n        })\n      },\n      onImageLoaded() {\n        this.keepMessageListOnButtom()\n      }\n    }\n  }\n</script>\n\n<style lang=\"stylus\" scoped>\n    /* 当前会话的骨架屏 */\n    .merger-conversation-wrapper\n        height 54vh\n        /*background-color #ffffff*/\n        color $base\n        display flex\n        .current-conversation\n            display: flex;\n            flex-direction: column;\n            width: 100%;\n            height: 100%;\n    .content\n        display: flex;\n        flex 1\n        flex-direction: column;\n        height: 100%;\n        overflow: hidden;\n        position: relative;\n        .message-list\n            width: 100%;\n            box-sizing: border-box;\n            overflow-y: scroll;\n            padding: 0 20px;\n\n    .footer\n        border-top: 1px solid $border-base;\n    .show-more {\n        text-align: right;\n        padding: 10px 20px 0 0;\n    }\n    /deep/ .el-checkbox {\n        width 100%\n    }\n    /deep/ .el-checkbox__label {\n        width 100%\n        padding-right 20px\n        box-sizing border-box\n    }\n    /deep/ .el-divider--horizontal {\n        display: block;\n        height: 1px;\n        width: 90%;\n        margin: 0 auto 8px;\n    }\n    .message-item {\n        display flex\n        /*border-bottom 1px solid #DEDEDE*/\n        /*padding-bottom  10px*/\n    }\n    .avatar-box {\n        .avatar {\n            width: 36px;\n            height: 36px;\n            border-radius: 50%;\n            box-shadow: 0 5px 10px 0 rgba(0, 0, 0, 0.1);\n        }\n    }\n    .container-box {\n        display flex\n        flex-direction column\n        .nick-date {\n            font-size 12px\n            color #B3B3B3\n            display flex\n            flex-direction row\n            .name {\n                margin 0 5px\n            }\n        }\n\n    }\n</style>\n"]}]}