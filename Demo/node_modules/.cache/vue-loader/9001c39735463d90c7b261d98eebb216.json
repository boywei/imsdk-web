{"remainingRequest":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/src/components/friend/friend-container.vue?vue&type=style&index=0&lang=stylus&scpoed=true&","dependencies":[{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/src/components/friend/friend-container.vue","mtime":1648707124000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/css-loader/index.js","mtime":499162500000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":499162500000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/stylus-loader/index.js","mtime":1519606876000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n.friend-content {\n    /*width 60%*/\n    width 100%\n    .friend-box {\n        margin 100px auto 0\n        width 360px\n        .profile-container {\n            display flex\n            justify-content space-between\n            .item-nick {\n                width 200px\n                line-height 48px\n            }\n            .avatar {\n                display block\n                width 48px\n                height 48px\n                border-radius 50%\n                margin-right 25px\n            }\n        }\n        .el-input {\n            width 50%\n        }\n        .el-select .el-input {\n            width 100%\n        }\n        .content-box {\n            display flex\n            /*justify-content space-between*/\n            margin 18px 0\n            .text-content {\n                height 40px\n            }\n            .text-box {\n                display flex\n                justify-content center\n                align-items center\n            }\n            .content-title {\n                display inline-block\n                min-width 80px\n                font-size 16px\n                color #717175\n                margin-right 140px\n            }\n            .content-text {\n                font-size 18px\n                color #000000\n                word-break break-word\n            }\n            .content-width {\n                display inline-block\n                max-width 115px\n                height 28px\n            }\n            .edit-icon {\n                cursor: pointer\n                font-size 16px\n                margin-left 6px\n                margin-top 8px\n            }\n\n        }\n\n        .sendBtn {\n            cursor pointer\n            width 120px\n            height 40px\n            border-radius 5px\n            background-color #00A4FF\n            color #ffffff\n            font-size 16px\n            margin 80px auto 0\n            text-align center\n            line-height 40px\n        }\n\n        .delete-text {\n            position absolute\n            cursor pointer\n            left 0\n            right 0\n            margin auto\n            bottom 25px\n            width 120px\n            height 40px\n            font-size 17px\n            color #586B95\n            text-align center\n        }\n        .application-box {\n            display flex\n            justify-content space-between\n        }\n        .application-delete {\n            cursor pointer\n            width 120px\n            height 40px\n            border-radius 5px\n            border 1px solid #00A4FF\n            color #1c2438\n            font-size 16px\n            margin-top 80px\n            text-align center\n            line-height 40px\n        }\n        .application-refuse {\n            cursor pointer\n            width 120px\n            height 40px\n            border-radius 5px\n            background-color #00A4FF\n            border 1px solid #00A4FF\n            color #ffffff\n            font-size 16px\n            margin-top 80px\n            text-align center\n            line-height 40px\n        }\n    }\n}\n\n\n",{"version":3,"sources":["friend-container.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsVA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"friend-container.vue","sourceRoot":"src/components/friend","sourcesContent":["<template>\n    <div class=\"friend-content\" v-if=\"showFriendContent || showApplicationContent\" @click=\"closeHandler\">\n        <div class=\"friend-box\" v-if=\"showFriendContent\">\n            <div class=\"profile-container\" >\n                <div class=\"item-nick text-ellipsis\">{{friendProfile.profile.nick||friendProfile.profile.userID}}</div>\n                <img\n                        class=\"avatar\"\n                        :src=\"friendProfile.profile.avatar ? friendProfile.profile.avatar : 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png'\"\n                />\n            </div>\n            <el-divider></el-divider>\n            <p class=\"content-box\"><span class=\"content-title\">userID</span><span class=\"content-text\">{{friendProfile.userID}}</span></p>\n            <div class=\"content-box\"><span class=\"content-title\">备注名</span>\n                <div class=\"text-box\"   v-if=\"!showEditRemark\">\n                    <span class=\"content-text  content-width text-ellipsis\">{{friendProfile.remark || '暂无'}}</span>\n                    <i\n                            class=\"el-icon-edit\"\n                            @click.stop=\"\n                        showEditRemark = true\n                        inputFocus('showEditRemark')\n\n            \"\n                            style=\"cursor:pointer; font-size:16px; margin-left: 6px\"\n                    />\n                </div>\n                <el-input\n                        style=\"display: inline-block\"\n                        ref=\"showEditRemark\"\n                        v-else\n                        autofocus\n                        v-model=\"profileRemark\"\n                        size=\"mini\"\n                        @blur=\"blurHandler\"\n                        @keydown.enter.native=\"editRemarkHandler\"\n                />\n            </div>\n\n            <p class=\"content-box\"><span class=\"content-title\">来源</span><span class=\"content-text\">{{getSource(friendProfile.source)}}</span></p>\n            <el-divider></el-divider>\n            <div class=\"content-box\" v-show=\"friendType==='friendList'\">\n                <span class=\"content-title\" v-show=\"!showEdit\" style=\"line-height: 35px\">所在分组</span>\n                <span class=\"content-title\" v-show=\"showEdit\"  style=\"line-height: 35px\">添加到分组</span>\n                <div class=\"text-content\">\n                    <span class=\"content-text\" v-show=\"!showEdit\">{{groupName}}</span>\n                    <i class=\"el-icon-edit edit-icon\" v-show=\"!showEdit\"   @click.stop=\"showEditHandler\"></i>\n                </div>\n                <el-select v-if=\"showEdit\" v-model=\"addGroupName\"  placeholder=\"选择分组\" @change=\"addToFriendGroup\">\n                    <el-option\n                            v-for=\"item in friendGroupList\"\n                            @blur=\"showEdit = false\"\n                            :key=\"item.name\"\n                            :label=\"item.name\"\n                            :value=\"item.name\">\n                    </el-option>\n                </el-select>\n            </div>\n            <p class=\"content-box\" v-show=\"friendType==='groupFriend'\" style=\"height: 40px\">\n                <span class=\"content-title\" style=\"line-height: 35px\">所在分组</span>\n                <span class=\"content-text\" v-show=\"!showEdit\" style=\"line-height: 35px\">{{groupName}}</span>\n            </p>\n            <div class=\"sendBtn\" @click.stop=\"checkoutConversation(friendProfile.userID)\">发送消息</div>\n            <div class=\"delete-text\" v-show=\"friendType==='groupFriend'\" @click.stop=\"removeFromFriendGroup(friendProfile.userID)\">从该群组中移除</div>\n            <div class=\"delete-text\" v-show=\"friendType==='friendList'\" @click.stop=\"removeFromFriendList(friendProfile.userID)\">删除该好友</div>\n        </div>\n        <div class=\"friend-box\" v-if=\"showApplicationContent\">\n            <div class=\"profile-container\" >\n                <div class=\"item-nick text-ellipsis\">{{applicationContent.nick||applicationContent.userID}}</div>\n                <img\n                        class=\"avatar\"\n                        :src=\"applicationContent.avatar ? applicationContent.avatar : 'http://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png'\"\n                />\n            </div>\n            <el-divider></el-divider>\n            <p class=\"content-box\"><span class=\"content-title\">userID</span><span class=\"content-text\">{{applicationContent.userID}}</span></p>\n            <p class=\"content-box\"><span class=\"content-title\">来源</span><span class=\"content-text content-width text-ellipsis\">{{getSource(applicationContent.source)}}</span></p>\n            <div class=\"content-box\" v-if=\"showRemark\"><span class=\"content-title\">备注名</span>\n                <el-input\n                        style=\"display: inline-block\"\n                        ref=\"showRemark\"\n                        autofocus\n                        v-model=\"acceptApplication.remark\"\n                        size=\"mini\"\n                        @blur=\"remarkBlurHandler\"\n                        @keydown.enter.native=\"editRemarkHandler\"\n                />\n            </div>\n            <el-divider></el-divider>\n            <p class=\"content-box\">\n                <span class=\"content-title\">打招呼</span>\n                <el-tooltip class=\"item\" effect=\"dark\" :content=\"applicationContent.wording\" placement=\"bottom-end\">\n                    <span class=\"content-text content-width text-ellipsis\">{{applicationContent.wording}}</span>\n                </el-tooltip>\n            </p>\n            <div class=\"application-box\" v-if=\"!showRemark\">\n                <p class=\"application-refuse\" @click=\"acceptHandler\">同意</p>\n                <p class=\"application-delete\"  @click=\"refuseFriendApplication(applicationContent.userID)\">拒绝</p>\n            </div>\n            <div class=\"application-box\" v-else>\n                <p class=\"application-refuse\" @click=\"acceptFriendApplication(applicationContent.userID)\">确认</p>\n                <p class=\"application-delete\"  @click=\"cancelHandler()\">取消</p>\n            </div>\n        </div>\n    </div>\n</template>\n\n<script>\n  import { mapState } from 'vuex'\n  export default {\n    name: 'index',\n    data() {\n      return {\n        showEdit: false,\n        showEditRemark: false,\n        showRemark: false,\n        addGroupName: '',\n        profileRemark: '',\n        editGroupList: [],\n        isUpdate: false,\n        acceptApplication: {\n          remark: '',\n          type: 'Response_Action_AgreeAndAdd',\n        },\n      }\n    },\n    computed: {\n      ...mapState({\n        friendContent: state => state.friend.friendContent,\n        applicationContent: state => state.friend.applicationContent,\n        friendGroupList: state => state.friend.friendGroupList,\n      }),\n      showFriendContent() {\n        if (JSON.stringify(this.friendContent) === '{}') {\n          return false\n        }\n        return true\n      },\n      showApplicationContent() {\n        if (JSON.stringify(this.applicationContent) === '{}') {\n          return false\n        }\n        return true\n      },\n      friendProfile() {\n        return this.friendContent.friend\n      },\n      groupName() {\n        if(this.friendProfile.groupList.length>0) {\n          return this.friendProfile.groupList.join(',')\n        }else {\n          return '暂无分组'\n        }\n      },\n      groupList:{\n        get() {\n          return this.friendProfile.groupList\n        },\n        set(value) {\n          this.editGroupList = value\n        }\n      },\n      friendType() {\n        return this.friendContent.type\n      },\n      getSource() {\n        return function (source) {\n          return source.substring(15)\n        }\n      },\n    },\n    methods: {\n      showEditHandler() {\n        this.showEdit = true\n        this.addGroupName = ''\n      },\n      inputFocus(ref) {\n        this.profileRemark = this.friendProfile.remark\n        this.$nextTick(() => {\n          this.$refs[ref].focus()\n        })\n      },\n      blurHandler() {\n        this.showEditRemark = false\n        this.isUpdate = true\n      },\n      remarkBlurHandler() {\n        // this.showEditRemark = false\n      },\n      acceptHandler() {\n        this.showRemark = true\n        this.acceptApplication.remark = ''\n        this.$nextTick(() => {\n          this.$refs.showRemark.focus()\n        })\n      },\n      cancelHandler() {\n        this.showRemark = false\n      },\n      closeHandler() {\n        this.showEdit = false\n        if (this.isUpdate) {\n          this.editRemarkHandler()\n        }\n      },\n      editRemarkHandler() {\n        this.showEditRemark = false\n        // 更新好友备注\n        this.tim.updateFriend({\n          userID: this.friendProfile.userID,\n          remark: this.profileRemark\n        }).then(()=> {\n        }).catch((imError)=> {\n          console.warn('getFriendProfile error:', imError) // 更新失败\n        })\n        this.isUpdate = false\n      },\n      updateFriendGroup() {\n        this.profileRemark = this.friendProfile.remark\n        // 更新好友分组\n        this.tim.updateFriend({\n          userID: this.friendProfile.userID,\n          groupList: this.editGroupList\n        }).then(()=>{\n        }).catch((imError)=> {\n          console.warn('getFriendProfile error:', imError) // 更新失败\n        })\n      },\n      checkoutConversation(userID) {\n        this.$store\n          .dispatch('checkoutConversation', `C2C${userID}`)\n          .then(() => {\n            this.showDialog = false\n            this.$bus.$emit('checkoutConversation')\n          }).catch(() => {\n          this.$store.commit('showMessage', {\n            message: '没有找到该用户',\n            type: 'warning'\n          })\n        })\n      },\n      addToFriendGroup() {\n        this.tim.addToFriendGroup({name: this.addGroupName, userIDList: [this.friendProfile.userID]}).then(() => {\n          this.$store.commit('showMessage', {\n            message: '添加成功',\n            type: 'success'\n          })\n        }).catch((error) => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n        this.showEdit = false\n      },\n      removeFromFriendGroup(userID) {\n        this.tim.removeFromFriendGroup({\n          name: this.friendContent.groupName,\n          userIDList: [userID],\n        }).then(() => {\n          this.resetContent() // 清空页面\n        }).catch(() => {\n        })\n      },\n      removeFromFriendList(userID) {\n        this.tim.deleteFriend({\n          userIDList: [userID],\n          type: 'Delete_Type_Both'\n        }).then(() => {\n          this.resetContent() // 清空页面\n        }).catch(error => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n      },\n      // 同意\n      acceptFriendApplication(userID) {\n        this.tim.acceptFriendApplication({\n          userID: userID,\n          remark: this.acceptApplication.remark,\n          tag: this.acceptApplication.tag,\n          type: this.acceptApplication.type\n        }).then(() => {\n          this.resetContent()\n          this.$store.commit('showMessage', {\n            message: '已同意加好友',\n            type: 'success'\n          })\n\n        }).catch((error) => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n        this.acceptApplication.remark = ''\n        this.showRemark = false\n      },\n      // application\n      deleteFriendApplication(application) {\n        this.$store.commit('updateUnreadCount', 0)\n        this.tim.deleteFriendApplication({userID: application.userID ,type: application.type}).then(() => {\n          this.resetContent() // 清空页面\n          this.$store.commit('showMessage', {\n            message: '已删除',\n            type: 'success'\n          })\n        }).catch((error) => {\n          this.$store.commit('showMessage', {\n            type: 'error',\n            message: error.message\n          })\n        })\n      },\n      // 拒绝\n      refuseFriendApplication(userID) {\n        this.$store.commit('updateUnreadCount', 0)\n        this.tim.refuseFriendApplication({\n          userID: userID\n        }).then(() => {\n          this.resetContent() // 清空页面\n          this.$store.commit('showMessage', {\n            message: '已拒绝',\n            type: 'success'\n          }).catch((error) => {\n            this.$store.commit('showMessage', {\n              type: 'error',\n              message: error.message\n            })\n          })\n        })\n      },\n      resetContent() {\n        this.$store.commit('resetCurrentConversation')\n        this.$store.commit('resetFriendContent')\n        this.$store.commit('resetApplicationContent')\n      }\n    }\n  }\n</script>\n\n<style lang=\"stylus\" scpoed>\n    .friend-content {\n        /*width 60%*/\n        width 100%\n        .friend-box {\n            margin 100px auto 0\n            width 360px\n            .profile-container {\n                display flex\n                justify-content space-between\n                .item-nick {\n                    width 200px\n                    line-height 48px\n                }\n                .avatar {\n                    display block\n                    width 48px\n                    height 48px\n                    border-radius 50%\n                    margin-right 25px\n                }\n            }\n            .el-input {\n                width 50%\n            }\n            .el-select .el-input {\n                width 100%\n            }\n            .content-box {\n                display flex\n                /*justify-content space-between*/\n                margin 18px 0\n                .text-content {\n                    height 40px\n                }\n                .text-box {\n                    display flex\n                    justify-content center\n                    align-items center\n                }\n                .content-title {\n                    display inline-block\n                    min-width 80px\n                    font-size 16px\n                    color #717175\n                    margin-right 140px\n                }\n                .content-text {\n                    font-size 18px\n                    color #000000\n                    word-break break-word\n                }\n                .content-width {\n                    display inline-block\n                    max-width 115px\n                    height 28px\n                }\n                .edit-icon {\n                    cursor: pointer\n                    font-size 16px\n                    margin-left 6px\n                    margin-top 8px\n                }\n\n            }\n\n            .sendBtn {\n                cursor pointer\n                width 120px\n                height 40px\n                border-radius 5px\n                background-color #00A4FF\n                color #ffffff\n                font-size 16px\n                margin 80px auto 0\n                text-align center\n                line-height 40px\n            }\n\n            .delete-text {\n                position absolute\n                cursor pointer\n                left 0\n                right 0\n                margin auto\n                bottom 25px\n                width 120px\n                height 40px\n                font-size 17px\n                color #586B95\n                text-align center\n            }\n            .application-box {\n                display flex\n                justify-content space-between\n            }\n            .application-delete {\n                cursor pointer\n                width 120px\n                height 40px\n                border-radius 5px\n                border 1px solid #00A4FF\n                color #1c2438\n                font-size 16px\n                margin-top 80px\n                text-align center\n                line-height 40px\n            }\n            .application-refuse {\n                cursor pointer\n                width 120px\n                height 40px\n                border-radius 5px\n                background-color #00A4FF\n                border 1px solid #00A4FF\n                color #ffffff\n                font-size 16px\n                margin-top 80px\n                text-align center\n                line-height 40px\n            }\n        }\n    }\n\n\n</style>\n"]}]}