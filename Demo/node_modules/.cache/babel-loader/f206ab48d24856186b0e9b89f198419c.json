{"remainingRequest":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/babel-loader/lib/index.js!/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/cache-loader/dist/cjs.js??ref--0-0!/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/src/components/group-live/components/live-header.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/src/components/group-live/components/live-header.vue","mtime":1648707124000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/babel.config.js","mtime":1648707124000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es7.object.get-own-property-descriptors\";\nimport \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es6.object.keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/@babel/runtime-corejs2/helpers/esm/asyncToGenerator.js\";\nimport _defineProperty from \"/Users/wei/IdeaProjects/boywei/imsdk-web/Demo/node_modules/@babel/runtime-corejs2/helpers/esm/defineProperty.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapState } from 'vuex';\nexport default {\n  name: 'liveHeader',\n  props: {\n    fr: {\n      type: String,\n      requred: true\n    },\n    isPushingStream: {\n      type: Boolean,\n      default: false\n    },\n    stopPushStream: {\n      type: Function\n    },\n    pusherTime: {\n      type: String,\n      default: ''\n    }\n  },\n  data: function data() {\n    return {\n      nick: '',\n      avatar: 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png',\n      onlineMemberCount: 0,\n      timer: null,\n      onlineList: []\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapState({\n    groupLiveInfo: function groupLiveInfo(state) {\n      return state.groupLive.groupLiveInfo;\n    }\n  })), {}, {\n    showLiveInfo: function showLiveInfo() {\n      return this.fr === 'pusher' && this.isPushingStream || this.fr === 'player';\n    },\n    roomName: function roomName() {\n      return this.groupLiveInfo.roomName || \"\".concat(this.groupLiveInfo.anchorID, \"\\u7684\\u76F4\\u64AD\");\n    }\n  }),\n  mounted: function mounted() {\n    var _this = this;\n\n    this.getAnchorProfile();\n\n    if (this.fr === 'player') {\n      this.timer = setInterval(function () {\n        _this.getGroupOnlineMemberCount();\n      }, 5000);\n    }\n  },\n  beforeDestroy: function beforeDestroy() {\n    this.timer && clearInterval(this.timer);\n  },\n  methods: {\n    closeLiveMask: function closeLiveMask() {\n      if (this.fr === 'pusher') {\n        this.stopPushStream();\n        return;\n      }\n\n      this.$store.commit('updateGroupLiveInfo', {\n        isNeededQuitRoom: 1\n      });\n      this.$bus.$emit('close-group-live');\n    },\n    getAnchorProfile: function () {\n      var _getAnchorProfile = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.tim.getUserProfile({\n                  userIDList: [this.groupLiveInfo.anchorID]\n                });\n\n              case 2:\n                res = _context.sent;\n\n                if (res.code === 0) {\n                  this.nick = res.data[0].nick || res.data[0].userID;\n                  this.avatar = res.data[0].avatar || 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png';\n                }\n\n              case 4:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function getAnchorProfile() {\n        return _getAnchorProfile.apply(this, arguments);\n      }\n\n      return getAnchorProfile;\n    }(),\n    getGroupOnlineMemberCount: function () {\n      var _getGroupOnlineMemberCount = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var res;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _context2.next = 2;\n                return this.tim.getGroupOnlineMemberCount(this.groupLiveInfo.roomID);\n\n              case 2:\n                res = _context2.sent;\n\n                if (res.code === 0 && res.data) {\n                  this.onlineMemberCount = res.data.memberCount;\n                }\n\n              case 4:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function getGroupOnlineMemberCount() {\n        return _getGroupOnlineMemberCount.apply(this, arguments);\n      }\n\n      return getGroupOnlineMemberCount;\n    }()\n  },\n  watch: {\n    isPushingStream: function isPushingStream(val) {\n      var _this2 = this;\n\n      if (val && this.fr === 'pusher') {\n        this.timer = setInterval(function () {\n          _this2.getGroupOnlineMemberCount();\n        }, 5000);\n      }\n    }\n  }\n};",{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuBA;AACA;AACAA,oBADA;AAEAC;AACAC;AACAC,kBADA;AAEAC;AAFA,KADA;AAKAC;AACAF,mBADA;AAEAG;AAFA,KALA;AASAC;AACAJ;AADA,KATA;AAYAK;AACAL,kBADA;AAEAG;AAFA;AAZA,GAFA;AAmBAG,MAnBA,kBAmBA;AACA;AACAC,cADA;AAEAC,uFAFA;AAGAC,0BAHA;AAIAC,iBAJA;AAKAC;AALA;AAOA,GA3BA;AA4BAC,4CACAC;AACAC;AAAA;AAAA;AADA,IADA;AAIAC,gBAJA,0BAIA;AACA;AACA,KANA;AAOAC,YAPA,sBAOA;AACA;AACA;AATA,IA5BA;AAuCAC,SAvCA,qBAuCA;AAAA;;AACA;;AACA;AACA;AACA;AACA,OAFA,EAEA,IAFA;AAGA;AACA,GA9CA;AA+CAC,eA/CA,2BA+CA;AACA;AACA,GAjDA;AAkDAC;AACAC,iBADA,2BACA;AACA;AACA;AACA;AACA;;AACA;AAAAC;AAAA;AACA;AACA,KARA;AASAC,oBATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAUA;AAAAC;AAAA,kBAVA;;AAAA;AAUAC,mBAVA;;AAWA;AACA;AACA;AACA;;AAdA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAgBAC,6BAhBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAiBA,6DAjBA;;AAAA;AAiBAD,mBAjBA;;AAkBA;AACA;AACA;;AApBA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,GAlDA;AAyEAE;AACAxB;AAAA;;AACA;AACA;AACA;AACA,SAFA,EAEA,IAFA;AAGA;AACA;AAPA;AAzEA","names":["name","props","fr","type","requred","isPushingStream","default","stopPushStream","pusherTime","data","nick","avatar","onlineMemberCount","timer","onlineList","computed","mapState","groupLiveInfo","showLiveInfo","roomName","mounted","beforeDestroy","methods","closeLiveMask","isNeededQuitRoom","getAnchorProfile","userIDList","res","getGroupOnlineMemberCount","watch"],"sourceRoot":"src/components/group-live/components","sources":["live-header.vue"],"sourcesContent":["<template>\n  <div class=\"header-container\">\n    <div v-show=\"showLiveInfo\">\n      <div class=\"anchor-info\">\n        <img class=\"anchor-avatar\" :src=\"avatar\">\n        <div class=\"anchor-other\">\n          <p class=\"anchor-nick\">{{nick}}</p>\n          <p class=\"online-num\">在线：{{onlineMemberCount}}</p>\n        </div>\n      </div>\n      <div class=\"online-info\">\n        <p class=\"room-name\">直播中</p>\n        <img class=\"living-icon\" src=\"../../../assets/image/living-icon.gif\" />\n        <span>{{` ${pusherTime}`}}</span>\n      </div>\n    </div>\n    <div class=\"close-box\" @click=\"closeLiveMask\">\n      <i class=\"el-icon-circle-close\"></i>\n    </div>\n  </div>\n</template>\n\n<script>\n import { mapState } from 'vuex'\n  export default {\n    name: 'liveHeader',\n    props: {\n      fr: {\n        type: String,\n        requred: true\n      },\n      isPushingStream: {\n        type: Boolean,\n        default: false\n      },\n      stopPushStream: {\n        type: Function\n      },\n      pusherTime: {\n        type: String,\n        default: ''\n      }\n    },\n    data() {\n      return {\n        nick: '',\n        avatar: 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png',\n        onlineMemberCount: 0,\n        timer: null,\n        onlineList: []\n      }\n    },\n    computed: {\n      ...mapState({\n        groupLiveInfo: state => state.groupLive.groupLiveInfo\n      }),\n      showLiveInfo() {\n        return (this.fr === 'pusher' && this.isPushingStream) || this.fr === 'player'\n      },\n      roomName() {\n        return this.groupLiveInfo.roomName || `${this.groupLiveInfo.anchorID}的直播`\n      }\n    },\n    mounted() {\n      this.getAnchorProfile()\n      if (this.fr === 'player') {\n        this.timer = setInterval(() => {\n          this.getGroupOnlineMemberCount()\n        }, 5000)\n      }\n    },\n    beforeDestroy() {\n      this.timer && clearInterval(this.timer)\n    },\n    methods: {\n      closeLiveMask() {\n        if (this.fr === 'pusher') {\n          this.stopPushStream()\n          return\n        }\n        this.$store.commit('updateGroupLiveInfo', { isNeededQuitRoom: 1 })\n        this.$bus.$emit('close-group-live')\n      },\n      async getAnchorProfile() {\n        const res = await this.tim.getUserProfile({userIDList: [this.groupLiveInfo.anchorID]})\n        if (res.code === 0) {\n          this.nick = res.data[0].nick || res.data[0].userID\n          this.avatar = res.data[0].avatar || 'https://imgcache.qq.com/open/qcloud/video/act/webim-avatar/avatar-2.png'\n        }\n      },\n      async getGroupOnlineMemberCount() {\n        const res = await this.tim.getGroupOnlineMemberCount(this.groupLiveInfo.roomID)\n        if (res.code === 0 && res.data) {\n          this.onlineMemberCount = res.data.memberCount\n        }\n      }\n    },\n    watch: {\n      isPushingStream: function(val) {\n        if (val && this.fr === 'pusher') {\n          this.timer = setInterval(() => {\n            this.getGroupOnlineMemberCount()\n          }, 5000)\n        }\n      }\n    }\n  }\n</script>\n\n<style lang=\"stylus\" scoped>\n .header-container {\n   position absolute\n   left 0\n   top 0\n   width 100%\n   height 100%\n   box-sizing border-box\n   z-index 99\n   padding 10px 10px 10px 20px\n  .anchor-info {\n    position absolute\n    top 50%\n    transform translateY(-50%)\n    width 200px\n    height 50px\n    background rgba(255, 255 ,255 ,0.1)\n    border-radius 30px\n    display flex\n    align-items center\n    .anchor-avatar {\n      width 50px\n      height 50px\n      border-radius 50%\n      margin 0 5px\n    }\n    .anchor-other {\n      height 100%\n      flex 1\n      p {\n        margin 0\n      }\n      .anchor-nick{\n        max-width 140px\n        margin 6px 0 0 0\n        color: #ffffff\n        font-weight 500\n        word-break keep-all\n        overflow hidden\n        text-overflow ellipsis\n        white-space nowrap\n      }\n      .online-num{\n        font-size 14px\n        font-weight 400\n        color #d2cbcbad\n      }\n    }\n  }\n  .online-info {\n    position absolute\n    left 50%\n    top 50%\n    transform translate(-50%, -50%)\n    height 50px\n    color #fff\n    display flex\n    align-items center\n    .room-name{\n      display inline-block\n      max-width 160px\n      overflow hidden\n      white-space nowrap\n      text-overflow ellipsis\n      margin 0\n      padding 0 0 0 10px\n    }\n    .living-icon{\n      position relative\n      top -3px\n      margin 0 5px\n      width 25px\n    }\n    span {\n      margin 2px 0 0 0\n    }\n  }\n  .close-box {\n    position absolute\n    right 0\n    top 0px\n    width 70px\n    height 70px\n    color: #959798\n    font-size 36px\n    cursor pointer\n    display flex\n    align-items center\n    justify-content center\n  }\n }\n</style>\n"]}]}